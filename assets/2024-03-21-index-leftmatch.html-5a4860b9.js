import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{o as i,c as a,f as n}from"./app-cde7bdd1.js";const r={},d=n('<p>索引最左匹配原则是数据库系统在使用联合索引（Composite Index）时的一个重要原则。这个原则指出，在查询条件中如果使用了联合索引的一部分，那么数据库系统可以利用这个索引进行快速检索，但是查询条件必须从索引的最左边列开始，依次向右。如果使用的不好，可能会导致索引失效。</p><p>本文将以案例的形式讲解联合索引的最左匹配原则。</p><h3 id="数据准备" tabindex="-1"><a class="header-anchor" href="#数据准备" aria-hidden="true">#</a> 数据准备</h3><p>创建表字段如下：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>CREATE TABLE `user` (\n  `id` int(11) unsigned NOT NULL AUTO_INCREMENT COMMENT &#39;ID&#39;,\n  `id_no` varchar(18) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT &#39;身份编号&#39;,\n  `username` varchar(32) CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT &#39;用户名&#39;,\n  `age` int(11) DEFAULT NULL COMMENT &#39;年龄&#39;,\n  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT &#39;创建时间&#39;,\n  PRIMARY KEY (`id`),\n  KEY `union_idx` (`id_no`,`username`,`age`),\n  KEY `create_time_idx` (`create_time`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin;\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>初始化表数据语句如下：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>INSERT INTO `user` (`id`, `id_no`, `username`, `age`, `create_time`) VALUES (null, &#39;11&#39;, &#39;forezp1&#39;, 11, &#39;2024-03-11 01:01:11&#39;);\nINSERT INTO `user` (`id`, `id_no`, `username`, `age`, `create_time`) VALUES (null, &#39;12&#39;, &#39;forezp2&#39;, 12, &#39;2024-03-11 01:01:11&#39;);\nINSERT INTO `user` (`id`, `id_no`, `username`, `age`, `create_time`) VALUES (null, &#39;13&#39;, &#39;forezp3&#39;, 13, &#39;2024-03-11 01:01:11&#39;);\nINSERT INTO `user` (`id`, `id_no`, `username`, `age`, `create_time`) VALUES (null, &#39;14&#39;, &#39;forezp4&#39;, 14, &#39;2024-03-11 01:01:11&#39;);\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="联合索引使用示例" tabindex="-1"><a class="header-anchor" href="#联合索引使用示例" aria-hidden="true">#</a> 联合索引使用示例</h3><h4 id="索引生效情况" tabindex="-1"><a class="header-anchor" href="#索引生效情况" aria-hidden="true">#</a> 索引生效情况：</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>explain select * from user where id_no = &#39;11&#39;;\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://static-1254191423.cos.ap-shanghai.myqcloud.com/img/2024/3/17/image-20240317183416893.png" alt="image-20240317183416893" tabindex="0" loading="lazy"><figcaption>image-20240317183416893</figcaption></figure><p>以下语句索引都生效：</p><ul><li>select * from user where id_no = &#39;11&#39; and username=&#39;forezp1&#39;;</li><li>select * from user where id_no = &#39;11&#39; and username=&#39;forezp1&#39; and age =11;</li><li>select * from user where id_no = &#39;11&#39; and age =11;</li></ul><h4 id="索引失效的情况" tabindex="-1"><a class="header-anchor" href="#索引失效的情况" aria-hidden="true">#</a> 索引失效的情况</h4><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>explain select * from user where  age =11;\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://static-1254191423.cos.ap-shanghai.myqcloud.com/img/2024/3/17/image-20240317183739509.png" alt="image-20240317183739509" tabindex="0" loading="lazy"><figcaption>image-20240317183739509</figcaption></figure><p>以下语句索引都失效：</p><ul><li>select * from user where username = &#39;forezp1&#39;;</li><li>explain select * from user where username = &#39;forezp1&#39; and age =11;</li></ul><h3 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结</h3><p>具体来说，假设有一个联合索引 (A, B, C)，在查询时，如果查询条件包含了索引的前缀列 A，那么数据库可以使用这个索引进行快速检索。但是，如果查询条件中没有包含索引的前缀列 A，而是直接使用了索引后面的列 B 或者 C，那么数据库通常无法使用这个索引，而需要进行全表扫描。</p>',20),s=[d];function t(l,c){return i(),a("div",null,s)}const o=e(r,[["render",t],["__file","2024-03-21-index-leftmatch.html.vue"]]);export{o as default};
